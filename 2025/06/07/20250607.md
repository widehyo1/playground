 awk 'FNR == 1 { print FILENAME } { print NR, FNR }' column.csv table.csv
column.csv
1 1
2 2
3 3
4 4
5 5
6 6
7 7
8 8
9 9
10 10
11 11
12 12
13 13
14 14
15 15
16 16
table.csv
17 1
18 2
19 3
20 4
21 5
22 6


function setCsvHeader(header) {
  fileCount++
  for (i = 1; i <= NF; i++) {
    headers[fileCount][i] = $i
  }
}

function join(arr, sep) {
  acc = arr[1]
  for (i = 2; i <= length(arr); i++) {
    acc = acc sep arr[i]
  }
  return acc
}

BEGIN {
  FS = ","
}
FNR == 1 { print FILENAME; setCsvHeader($0); next }
END {
  for (idx = 1; idx <= fileCount; idx++) {
    print "file count: " idx
    headerStr = join(headers[idx], ",")
    print headerStr
  }
}



function setCsvHeader(header) {
  print FILENAME;
  fileCount++
  for (i = 1; i <= NF; i++) {
    headers[fileCount][i] = $i
  }
}

function join(arr, sep) {
  acc = arr[1]
  for (i = 2; i <= length(arr); i++) {
    acc = acc sep arr[i]
  }
  return acc
}

BEGIN {
  FS = ","
}
FNR == 1 { setCsvHeader($0); next }
fileCount == 1 {
  tableInfo[$1] = $0
  next
}
fileCount == 2 {
  columnInfo[$2] = $0
  next
}

END {
  for (idx = 1; idx <= fileCount; idx++) {
    print "file count: " idx
    headerStr = join(headers[idx], ",")
    print headerStr
  }
  print "table"
  for (idx in tableInfo) {
    print idx ": " tableInfo[idx]
  }
  print "column"
  for (idx in columnInfo) {
    print idx ": " columnInfo[idx]
  }
}
