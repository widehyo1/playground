a539ad56-195f-4d97-9e42-d4745f6979a4
2e90e67e-43c2-4343-ac9c-8a78fa732077
f324f281-e327-49e0-bc10-6a05bc09b21a
4e01baf0-0b34-4322-a478-99da4bb98ef7
6b17b5dc-f73f-493f-aabe-ba3b96348900

d866f901-77a7-4834-b1eb-60de2db72896
d2240caa-e31d-4ee3-ab70-8cd6ed89fd92
a931a8c0-9377-4c3d-b1dd-e6e97b2a2646
a801c12e-725a-4bdc-a912-46f4ad2d751b
f17ff18c-8845-4fcc-b5fb-b2588ace5432
f1ce0326-721c-4303-a5a6-dce4950b85cb
8ee3dac5-088e-42db-ab3f-2443b082d78f
0ffe59fd-4eac-46f1-916d-e199b966d5b1
e44a0d48-2bc8-40da-a67a-e3ed3b7665e2
82a9274a-bb90-4529-9eda-a8d21c5ac6e7
b9e3e772-3a5c-41be-b193-8e0d27530738
9f72ab29-1991-404d-a2cf-ea932302cc5f
adf5de2a-0b96-4b14-a103-608b573c9000
b0a72f42-a1a9-410c-ac51-ce6fc7c9c461
9a8187b6-965d-46f1-8c6d-ab44c0178ed9

function strip(str) {
  gsub(/^\s+|\s+$/, "", str)
  return str
}

BEGIN {
  RS = ""
  FS = "\n"
}
NR == 1 {
  print "id,table_name"
  for (i = 1; i <= NF; i++) {
    tableIdArr[i] = $i
    print $i "," "table" i
  }
}
NR == 2 {
  print "table_id,id,column_name"
  for (i in tableIdArr) {
    for (j = 1; j <= i; j++) {
      colArr[i][j] = $j
      print tableIdArr[i] "," $j "," "column" j
    }
  }
}


id,table_name
a539ad56-195f-4d97-9e42-d4745f6979a4,table1
2e90e67e-43c2-4343-ac9c-8a78fa732077,table2
f324f281-e327-49e0-bc10-6a05bc09b21a,table3
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5
table_id,id,column_name
a539ad56-195f-4d97-9e42-d4745f6979a4,d866f901-77a7-4834-b1eb-60de2db72896,column1
2e90e67e-43c2-4343-ac9c-8a78fa732077,d866f901-77a7-4834-b1eb-60de2db72896,column1
2e90e67e-43c2-4343-ac9c-8a78fa732077,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
f324f281-e327-49e0-bc10-6a05bc09b21a,d866f901-77a7-4834-b1eb-60de2db72896,column1
f324f281-e327-49e0-bc10-6a05bc09b21a,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
f324f281-e327-49e0-bc10-6a05bc09b21a,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
4e01baf0-0b34-4322-a478-99da4bb98ef7,d866f901-77a7-4834-b1eb-60de2db72896,column1
4e01baf0-0b34-4322-a478-99da4bb98ef7,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
4e01baf0-0b34-4322-a478-99da4bb98ef7,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
4e01baf0-0b34-4322-a478-99da4bb98ef7,a801c12e-725a-4bdc-a912-46f4ad2d751b,column4
6b17b5dc-f73f-493f-aabe-ba3b96348900,d866f901-77a7-4834-b1eb-60de2db72896,column1
6b17b5dc-f73f-493f-aabe-ba3b96348900,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
6b17b5dc-f73f-493f-aabe-ba3b96348900,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
6b17b5dc-f73f-493f-aabe-ba3b96348900,a801c12e-725a-4bdc-a912-46f4ad2d751b,column4
6b17b5dc-f73f-493f-aabe-ba3b96348900,f17ff18c-8845-4fcc-b5fb-b2588ace5432,column5



BEGIN {
    cmd = "wc -l < " ARGV[1]
    cmd | getline num_lines
    close(cmd)
}


2025/05/31 on  main [✘!?] via 🐍 v3.10.12 ❯ csvlook table.csv
| id                                   | table_name |
| ------------------------------------ | ---------- |
| a539ad56-195f-4d97-9e42-d4745f6979a4 | table1     |
| 2e90e67e-43c2-4343-ac9c-8a78fa732077 | table2     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | table3     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | table4     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | table5     |

2025/05/31 on  main [✘!?] via 🐍 v3.10.12 ❯ csvlook column.csv
| table_id                             | id                                   | column_name |
| ------------------------------------ | ------------------------------------ | ----------- |
| a539ad56-195f-4d97-9e42-d4745f6979a4 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 2e90e67e-43c2-4343-ac9c-8a78fa732077 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 2e90e67e-43c2-4343-ac9c-8a78fa732077 | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | a931a8c0-9377-4c3d-b1dd-e6e97b2a2646 | column3     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | a931a8c0-9377-4c3d-b1dd-e6e97b2a2646 | column3     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | a801c12e-725a-4bdc-a912-46f4ad2d751b | column4     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | a931a8c0-9377-4c3d-b1dd-e6e97b2a2646 | column3     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | a801c12e-725a-4bdc-a912-46f4ad2d751b | column4     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | f17ff18c-8845-4fcc-b5fb-b2588ace5432 | column5     |

2025/05/31 on  main [✘!?] via 🐍 v3.10.12 ❯ csvjoin -c id,table_id table.csv column.csv
id,table_name,id2,column_name
a539ad56-195f-4d97-9e42-d4745f6979a4,table1,d866f901-77a7-4834-b1eb-60de2db72896,column1
2e90e67e-43c2-4343-ac9c-8a78fa732077,table2,d866f901-77a7-4834-b1eb-60de2db72896,column1
2e90e67e-43c2-4343-ac9c-8a78fa732077,table2,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
f324f281-e327-49e0-bc10-6a05bc09b21a,table3,d866f901-77a7-4834-b1eb-60de2db72896,column1
f324f281-e327-49e0-bc10-6a05bc09b21a,table3,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
f324f281-e327-49e0-bc10-6a05bc09b21a,table3,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,d866f901-77a7-4834-b1eb-60de2db72896,column1
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,a801c12e-725a-4bdc-a912-46f4ad2d751b,column4
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,d866f901-77a7-4834-b1eb-60de2db72896,column1
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,a801c12e-725a-4bdc-a912-46f4ad2d751b,column4
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,f17ff18c-8845-4fcc-b5fb-b2588ace5432,column5

2025/05/31 on  main [✘!?] via 🐍 v3.10.12 ❯ csvlook table.csv
| id                                   | table_name |
| ------------------------------------ | ---------- |
| a539ad56-195f-4d97-9e42-d4745f6979a4 | table1     |
| 2e90e67e-43c2-4343-ac9c-8a78fa732077 | table2     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | table3     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | table4     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | table5     |

2025/05/31 on  main [✘!?] via 🐍 v3.10.12 ❯ csvlook column.csv
| table_id                             | id                                   | column_name |
| ------------------------------------ | ------------------------------------ | ----------- |
| a539ad56-195f-4d97-9e42-d4745f6979a4 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 2e90e67e-43c2-4343-ac9c-8a78fa732077 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 2e90e67e-43c2-4343-ac9c-8a78fa732077 | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| f324f281-e327-49e0-bc10-6a05bc09b21a | a931a8c0-9377-4c3d-b1dd-e6e97b2a2646 | column3     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | a931a8c0-9377-4c3d-b1dd-e6e97b2a2646 | column3     |
| 4e01baf0-0b34-4322-a478-99da4bb98ef7 | a801c12e-725a-4bdc-a912-46f4ad2d751b | column4     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | d866f901-77a7-4834-b1eb-60de2db72896 | column1     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | d2240caa-e31d-4ee3-ab70-8cd6ed89fd92 | column2     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | a931a8c0-9377-4c3d-b1dd-e6e97b2a2646 | column3     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | a801c12e-725a-4bdc-a912-46f4ad2d751b | column4     |
| 6b17b5dc-f73f-493f-aabe-ba3b96348900 | f17ff18c-8845-4fcc-b5fb-b2588ace5432 | column5     |

2025/05/31 on  main [✘!?] via 🐍 v3.10.12 ❯ csvjoin -c id,table_id table.csv column.csv
id,table_name,id2,column_name
a539ad56-195f-4d97-9e42-d4745f6979a4,table1,d866f901-77a7-4834-b1eb-60de2db72896,column1
2e90e67e-43c2-4343-ac9c-8a78fa732077,table2,d866f901-77a7-4834-b1eb-60de2db72896,column1
2e90e67e-43c2-4343-ac9c-8a78fa732077,table2,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
f324f281-e327-49e0-bc10-6a05bc09b21a,table3,d866f901-77a7-4834-b1eb-60de2db72896,column1
f324f281-e327-49e0-bc10-6a05bc09b21a,table3,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
f324f281-e327-49e0-bc10-6a05bc09b21a,table3,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,d866f901-77a7-4834-b1eb-60de2db72896,column1
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
4e01baf0-0b34-4322-a478-99da4bb98ef7,table4,a801c12e-725a-4bdc-a912-46f4ad2d751b,column4
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,d866f901-77a7-4834-b1eb-60de2db72896,column1
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,d2240caa-e31d-4ee3-ab70-8cd6ed89fd92,column2
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,a931a8c0-9377-4c3d-b1dd-e6e97b2a2646,column3
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,a801c12e-725a-4bdc-a912-46f4ad2d751b,column4
6b17b5dc-f73f-493f-aabe-ba3b96348900,table5,f17ff18c-8845-4fcc-b5fb-b2588ace5432,column5

2025/05/31 on  main [✘!?] via 🐍 v3.10.12 ❯ csvjoin -c id,table_id table.csv column.csv | csvcut -c table_name,column_name | csvsort -c column_name
table_name,column_name
table1,column1
table2,column1
table3,column1
table4,column1
table5,column1
table2,column2
table3,column2
table4,column2
table5,column2
table3,column3
table4,column3
table5,column3
table4,column4
table5,column4
table5,column5


https://csvkit.readthedocs.io/en/latest/tricks.html
